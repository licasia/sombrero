generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
  importFileExtension = "js"
}

datasource db {
  provider = "sqlite"
}

model Escort {
  id                     Int                @id @default(autoincrement())
  ext_id                 String?
  is_active              Boolean?
  name                   String?
  phone                  String?
  pass_code              String?
  services               String?
  price                  Int?
  year                   Int?
  height                 Int?
  weight                 Int?
  bust                   Int?
  waist                  Int?
  hip                    Int?
  origin                 String?
  city                   String?
  district               String?
  area                   String?
  working_hours          String?
  extra_fees             String?
  primary_image_url      String?
  primary_image_filename String?
  images                 String?
  video_url              String?
  video_filename         String?
  description            String?
  address                String?
  valid_profile          Boolean?           @default(false)
  
  // Relations
  fetch_run_details      FetchRunDetail[]

  @@map("escorts")
}

model FetchRunDetail {
  id               Int              @id @default(autoincrement())
  escort_id        Int?
  status           String?
  
  // Relations
  escort           Escort?          @relation(fields: [escort_id], references: [id])
  process_attempts ProcessAttempt[]

  @@map("fetch_run_details")
}

model ProcessAttempt {
  id                   Int            @id @default(autoincrement())
  fetch_run_details_id Int
  fetch_run_id         Int
  attempt_number       Int?           @default(1)
  extracted_data       String?        // Maps to TEXT
  is_success           Boolean?       @default(false)
  failure_reason       String?
  created_at           DateTime?      @default(now())

  // Relations
  fetch_run_detail     FetchRunDetail @relation(fields: [fetch_run_details_id], references: [id])
  fetch_run            FetchRun       @relation(fields: [fetch_run_id], references: [id])

  @@map("process_attempts")
}

model FetchRun {
  id               Int              @id @default(autoincrement())
  run_type         String
  model_used       String?
  input_data       String?          // Maps to TEXT
  raw_result       String?          // Maps to TEXT
  status           String?          @default("pending")
  created_at       DateTime?        @default(now())

  // Relations
  process_attempts ProcessAttempt[]

  @@map("fetch_runs")
}
